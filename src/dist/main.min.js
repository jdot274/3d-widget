"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var THREE=_interopRequireWildcard(require("three")),_Grid=_interopRequireDefault(require("./components/Grid.js")),_sceneConfig=_interopRequireDefault(require("./scene.config.json")),_RGBELoader=require("three/examples/jsm/loaders/RGBELoader.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};var r=_getRequireWildcardCache();if(r&&r.has(e))return r.get(e);var n={},t=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=t?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}require("/styles/global.css");var scene,camera,renderer,grid,animationFrameId=null,clock=new THREE.Clock;function init(){var r,n,t,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Initializing app with simplified approach..."),document.body.style.backgroundColor="transparent",document.documentElement.style.backgroundColor="transparent",(scene=new THREE.Scene).background=null,(camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3)).position.set(0,0,5),(renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0,premultipliedAlpha:!1,preserveDrawingBuffer:!0})).setSize(window.innerWidth,window.innerHeight),renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),renderer.setClearColor(0,0),renderer.setClearAlpha(0),(r=document.getElementById("app")).style.backgroundColor="transparent",r.appendChild(renderer.domElement),addVisibilityCube(),n=new THREE.AmbientLight(16777215,1.5),scene.add(n),(t=new THREE.DirectionalLight(16777215,2)).position.set(5,5,5),scene.add(t),grid=new _Grid.default(scene),e.next=24,regeneratorRuntime.awrap(loadEnvironmentMap());case 24:i=e.sent,scene.environment=i,window.addEventListener("resize",onWindowResize),animate(),console.log("Animation loop started");case 29:case"end":return e.stop()}})}function addVisibilityCube(){var e=new THREE.BoxGeometry(1,1,1),r=new THREE.MeshStandardMaterial({color:16711680,emissive:16711680,emissiveIntensity:.5,metalness:.7,roughness:.2}),n=new THREE.Mesh(e,r);n.position.set(0,0,0),scene.add(n),console.log("Visibility cube added")}function loadEnvironmentMap(){var r,t,n,i,o,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Loading environment map..."),(r=new THREE.PMREMGenerator(renderer)).compileEquirectangularShader(),e.prev=3,t=new _RGBELoader.RGBELoader,e.next=7,regeneratorRuntime.awrap(new Promise(function(r,n){t.load("https://dl.polyhaven.org/file/ph-assets/HDRIs/hdr/1k/potsdamer_platz_1k.hdr",function(e){console.log("HDR texture loaded successfully"),e.mapping=THREE.EquirectangularReflectionMapping,r(e)},void 0,function(e){console.error("Failed to load HDR texture:",e),n(e)})}));case 7:return n=e.sent,i=r.fromEquirectangular(n).texture,n.dispose(),r.dispose(),console.log("Environment map loaded"),e.abrupt("return",i);case 15:return e.prev=15,e.t0=e.catch(3),console.error("Error loading environment map:",e.t0),o=r.fromScene(new THREE.Scene),a=o.texture,r.dispose(),o.dispose(),e.abrupt("return",a);case 23:case"end":return e.stop()}},null,null,[[3,15]])}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function animate(){animationFrameId=requestAnimationFrame(animate);var e=clock.getElapsedTime();if(renderer.setClearColor(0,0),renderer.setClearAlpha(0),renderer.autoClear=!1,renderer.clear(!0,!0,!0),grid&&grid.chips){var r=!0,n=!1,t=void 0;try{for(var i,o=grid.chips[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){i.value.update(e)}}catch(e){n=!0,t=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw t}}}renderer.render(scene,camera)}init().catch(function(e){console.error("Initialization error:",e);var r=document.getElementById("app");r&&(r.innerHTML='<div style="color: red; padding: 20px; font-size: 24px; background: rgba(0,0,0,0.7);">\n      Error initializing 3D scene. See console for details.\n    </div>')});
//# sourceMappingURL=main.min.js.map
